<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DepreciationIQ - Platform</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        :root{--navy-900:#0A1628;--navy-800:#0F2140;--navy-700:#162D54;--navy-600:#1E3A68;--teal-400:#2DD4BF;--teal-500:#14B8A6;--teal-600:#0D9488;--teal-glow:rgba(45,212,191,0.15);--white:#FFFFFF;--gray-300:#CBD5E1;--gray-400:#94A3B8;--gray-500:#64748B;--green-400:#4ADE80;--green-500:#22C55E;--red-400:#F87171;--red-500:#EF4444;--yellow-400:#FACC15}
        *{margin:0;padding:0;box-sizing:border-box}
        body{font-family:'DM Sans',sans-serif;background:var(--navy-900);color:var(--white);min-height:100vh}
        .hidden{display:none!important}
        .view{display:none}.view.active{display:block}
        .auth-container{min-height:100vh;display:flex;align-items:center;justify-content:center;padding:24px;background:radial-gradient(ellipse 80% 50% at 50% -20%,rgba(45,212,191,0.12),transparent),var(--navy-900)}
        .auth-card{width:100%;max-width:440px;background:var(--navy-800);border:1px solid var(--navy-600);border-radius:20px;padding:48px 40px;position:relative}
        .auth-card::before{content:'';position:absolute;top:0;left:0;right:0;height:3px;background:linear-gradient(90deg,var(--teal-400),var(--teal-600));border-radius:20px 20px 0 0}
        .logo{display:flex;align-items:center;gap:12px;justify-content:center;margin-bottom:32px}
        .logo svg{width:44px;height:44px}
        .logo-text{font-size:24px;font-weight:700}.logo-text span{color:var(--teal-400)}
        .auth-title{font-size:28px;font-weight:700;text-align:center;margin-bottom:8px}
        .auth-subtitle{text-align:center;color:var(--gray-400);margin-bottom:32px;font-size:15px}
        .auth-form{display:flex;flex-direction:column;gap:20px}
        .form-group{display:flex;flex-direction:column;gap:8px}
        .form-label{font-size:14px;font-weight:600;color:var(--gray-300)}
        .form-input,.form-select{width:100%;background:var(--navy-700);border:1px solid var(--navy-600);border-radius:10px;padding:14px 16px;color:var(--white);font-size:15px;font-family:inherit}
        .form-input:focus,.form-select:focus{outline:none;border-color:var(--teal-400);box-shadow:0 0 0 3px var(--teal-glow)}
        .form-input::placeholder{color:var(--gray-500)}
        .form-row{display:grid;grid-template-columns:1fr 1fr;gap:16px}
        .btn{display:inline-flex;align-items:center;justify-content:center;gap:8px;padding:14px 24px;border-radius:10px;font-size:15px;font-weight:600;cursor:pointer;transition:all 0.2s;border:none;font-family:inherit}
        .btn-primary{background:linear-gradient(135deg,var(--teal-400),var(--teal-600));color:var(--navy-900)}
        .btn-primary:hover{transform:translateY(-2px);box-shadow:0 8px 24px rgba(45,212,191,0.35)}
        .btn-secondary{background:var(--navy-700);color:var(--white);border:1px solid var(--navy-600)}
        .btn-secondary:hover{background:var(--navy-600)}
        .btn-danger{background:var(--red-500);color:var(--white)}
        .btn-ghost{background:transparent;color:var(--gray-300);padding:8px 16px}
        .btn-full{width:100%}
        .btn-sm{padding:10px 16px;font-size:14px}
        .auth-footer{text-align:center;margin-top:24px;font-size:14px;color:var(--gray-400)}
        .auth-footer a{color:var(--teal-400);text-decoration:none;font-weight:500;cursor:pointer}
        .app-layout{display:flex;min-height:100vh}
        .sidebar{width:260px;background:var(--navy-800);border-right:1px solid var(--navy-600);padding:24px 16px;position:fixed;height:100vh;overflow-y:auto;display:flex;flex-direction:column;z-index:100}
        .sidebar-logo{display:flex;align-items:center;gap:12px;padding:0 12px;margin-bottom:32px}
        .sidebar-logo svg{width:36px;height:36px}
        .sidebar-logo .logo-text{font-size:20px}
        .nav-section{margin-bottom:24px}
        .nav-label{font-size:11px;font-weight:700;text-transform:uppercase;letter-spacing:0.05em;color:var(--gray-500);padding:0 12px;margin-bottom:8px}
        .nav-item{display:flex;align-items:center;gap:12px;padding:12px;border-radius:10px;cursor:pointer;transition:all 0.2s;font-size:14px;font-weight:500;color:var(--gray-400);margin-bottom:2px}
        .nav-item:hover{background:var(--navy-700);color:var(--white)}
        .nav-item.active{background:var(--teal-glow);color:var(--teal-400)}
        .nav-item svg{width:20px;height:20px;flex-shrink:0}
        .nav-badge{margin-left:auto;background:var(--teal-500);color:var(--navy-900);font-size:11px;font-weight:700;padding:2px 8px;border-radius:10px}
        .sidebar-footer{margin-top:auto;padding-top:20px;border-top:1px solid var(--navy-600)}
        .user-card{display:flex;align-items:center;gap:12px;padding:12px;border-radius:10px;cursor:pointer}
        .user-card:hover{background:var(--navy-700)}
        .user-avatar{width:40px;height:40px;border-radius:10px;background:linear-gradient(135deg,var(--teal-400),var(--teal-600));display:flex;align-items:center;justify-content:center;font-weight:700;font-size:14px;color:var(--navy-900)}
        .user-name{font-size:14px;font-weight:600}
        .user-plan{font-size:12px;color:var(--teal-400)}
        .main-content{flex:1;margin-left:260px;padding:32px;min-height:100vh}
        .page-header{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:32px;flex-wrap:wrap;gap:16px}
        .page-title{font-size:28px;font-weight:700}
        .page-subtitle{font-size:15px;color:var(--gray-400);margin-top:4px}
        .header-actions{display:flex;gap:12px;flex-wrap:wrap}
        .stats-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:20px;margin-bottom:32px}
        .stat-card{background:var(--navy-800);border:1px solid var(--navy-600);border-radius:16px;padding:24px;transition:all 0.2s}
        .stat-card:hover{border-color:var(--navy-500);transform:translateY(-2px)}
        .stat-icon{width:44px;height:44px;border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:20px;margin-bottom:16px}
        .stat-icon.teal{background:var(--teal-glow)}.stat-icon.green{background:rgba(34,197,94,0.15)}.stat-icon.purple{background:rgba(168,85,247,0.15)}.stat-icon.orange{background:rgba(249,115,22,0.15)}
        .stat-value{font-size:28px;font-weight:700;font-family:'JetBrains Mono',monospace;margin-bottom:4px}
        .stat-label{font-size:14px;color:var(--gray-400)}
        .card{background:var(--navy-800);border:1px solid var(--navy-600);border-radius:16px;overflow:hidden}
        .card-header{display:flex;justify-content:space-between;align-items:center;padding:20px 24px;border-bottom:1px solid var(--navy-600)}
        .card-title{font-size:16px;font-weight:600}
        .card-body{padding:24px}.card-body.np{padding:0}
        .content-grid{display:grid;grid-template-columns:1fr 400px;gap:24px;margin-bottom:32px}
        .asset-header{display:grid;grid-template-columns:2fr 1fr 1fr 100px;gap:16px;padding:12px 24px;background:var(--navy-700);font-size:12px;font-weight:600;color:var(--gray-400);text-transform:uppercase}
        .asset-row{display:grid;grid-template-columns:2fr 1fr 1fr 100px;gap:16px;padding:16px 24px;border-bottom:1px solid var(--navy-600);align-items:center;cursor:pointer;transition:background 0.2s}
        .asset-row:hover{background:var(--navy-700)}
        .asset-row:last-child{border-bottom:none}
        .asset-info{display:flex;align-items:center;gap:14px}
        .asset-icon{width:44px;height:44px;border-radius:10px;background:var(--navy-700);display:flex;align-items:center;justify-content:center;font-size:20px;flex-shrink:0}
        .asset-name{font-weight:600;margin-bottom:2px}
        .asset-type{font-size:13px;color:var(--gray-500)}
        .asset-value{font-family:'JetBrains Mono',monospace;font-weight:500}
        .dep-bar{width:100%;height:6px;background:var(--navy-600);border-radius:3px;overflow:hidden}
        .dep-fill{height:100%;background:linear-gradient(90deg,var(--teal-400),var(--teal-600));border-radius:3px}
        .status-badge{display:inline-flex;align-items:center;gap:6px;padding:6px 12px;border-radius:20px;font-size:12px;font-weight:600}
        .status-badge.active{background:rgba(34,197,94,0.15);color:var(--green-400)}
        .status-badge.sold{background:rgba(148,163,184,0.15);color:var(--gray-400)}
        .status-badge::before{content:'';width:6px;height:6px;border-radius:50%;background:currentColor}
        .quick-actions{display:grid;grid-template-columns:repeat(4,1fr);gap:16px;margin-bottom:32px}
        .quick-action{background:var(--navy-800);border:1px solid var(--navy-600);border-radius:12px;padding:20px;cursor:pointer;text-align:center;transition:all 0.2s}
        .quick-action:hover{border-color:var(--teal-400);background:var(--teal-glow)}
        .quick-action svg{width:32px;height:32px;color:var(--teal-400);margin:0 auto 12px}
        .quick-action .title{font-size:14px;font-weight:600}
        .quick-action .desc{font-size:12px;color:var(--gray-500);margin-top:4px}
        .alert-list{display:flex;flex-direction:column;gap:12px}
        .alert-item{display:flex;gap:14px;padding:16px;background:var(--navy-700);border-radius:12px;cursor:pointer;transition:all 0.2s}
        .alert-item:hover{transform:translateX(4px)}
        .alert-icon{width:40px;height:40px;border-radius:10px;display:flex;align-items:center;justify-content:center;flex-shrink:0;font-size:18px}
        .alert-icon.urgent{background:rgba(239,68,68,0.15)}.alert-icon.warning{background:rgba(234,179,8,0.15)}.alert-icon.info{background:var(--teal-glow)}
        .alert-title{font-size:14px;font-weight:600;margin-bottom:4px}
        .alert-desc{font-size:13px;color:var(--gray-400)}
        .alert-time{font-size:12px;color:var(--gray-500);white-space:nowrap;margin-left:auto}
        .calc-layout{display:grid;grid-template-columns:1fr 400px;gap:32px}
        .calc-form,.calc-results{background:var(--navy-800);border:1px solid var(--navy-600);border-radius:16px;padding:32px}
        .calc-results{height:fit-content;position:sticky;top:32px}
        .calc-title{font-size:18px;font-weight:600;margin-bottom:24px}
        .calc-grid{display:grid;grid-template-columns:1fr 1fr;gap:20px}
        .calc-grid .full{grid-column:span 2}
        .result-item{padding:16px 0;border-bottom:1px solid var(--navy-600)}
        .result-item:last-child{border-bottom:none}
        .result-label{font-size:13px;color:var(--gray-500);margin-bottom:4px}
        .result-value{font-size:24px;font-weight:700;font-family:'JetBrains Mono',monospace}
        .result-value.teal{color:var(--teal-400)}.result-value.green{color:var(--green-400)}
        .result-sub{font-size:13px;color:var(--gray-500);margin-top:4px}
        .schedule-table{width:100%;margin-top:24px;border-collapse:collapse}
        .schedule-table th,.schedule-table td{padding:12px;text-align:left;font-size:13px;border-bottom:1px solid var(--navy-600)}
        .schedule-table th{font-weight:600;color:var(--gray-400);text-transform:uppercase;font-size:11px}
        .schedule-table td{font-family:'JetBrains Mono',monospace}
        .schedule-table tbody tr:hover{background:var(--navy-700)}
        .chat-container{display:flex;flex-direction:column;height:calc(100vh - 180px)}
        .chat-messages{flex:1;overflow-y:auto;padding:24px;display:flex;flex-direction:column;gap:16px}
        .chat-message{display:flex;gap:12px;max-width:85%}
        .chat-message.user{align-self:flex-end;flex-direction:row-reverse}
        .chat-avatar{width:36px;height:36px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:14px;font-weight:700;flex-shrink:0}
        .chat-message.assistant .chat-avatar{background:linear-gradient(135deg,var(--teal-400),var(--teal-600));color:var(--navy-900)}
        .chat-message.user .chat-avatar{background:var(--navy-600);color:var(--white)}
        .chat-bubble{padding:16px;border-radius:16px;font-size:14px;line-height:1.6}
        .chat-message.assistant .chat-bubble{background:var(--navy-700);border-bottom-left-radius:4px}
        .chat-message.user .chat-bubble{background:var(--teal-600);color:var(--white);border-bottom-right-radius:4px}
        .chat-input-container{padding:24px;border-top:1px solid var(--navy-600);display:flex;gap:12px}
        .chat-input{flex:1;background:var(--navy-700);border:1px solid var(--navy-600);border-radius:12px;padding:14px 16px;color:var(--white);font-size:14px;font-family:inherit;resize:none}
        .chat-input:focus{outline:none;border-color:var(--teal-400)}
        .modal-overlay{position:fixed;inset:0;background:rgba(10,22,40,0.9);display:none;align-items:center;justify-content:center;z-index:1000;padding:24px}
        .modal-overlay.active{display:flex}
        .modal{background:var(--navy-800);border:1px solid var(--navy-600);border-radius:20px;width:100%;max-width:600px;max-height:90vh;overflow:hidden;display:flex;flex-direction:column}
        .modal-header{padding:24px;border-bottom:1px solid var(--navy-600);display:flex;justify-content:space-between;align-items:center}
        .modal-title{font-size:20px;font-weight:700}
        .modal-close{background:none;border:none;color:var(--gray-400);cursor:pointer;font-size:24px;width:40px;height:40px;display:flex;align-items:center;justify-content:center;border-radius:10px}
        .modal-close:hover{background:var(--navy-700);color:var(--white)}
        .modal-body{padding:24px;overflow-y:auto;flex:1}
        .modal-footer{padding:24px;border-top:1px solid var(--navy-600);display:flex;justify-content:flex-end;gap:12px}
        .search-bar{display:flex;gap:12px;margin-bottom:24px}
        .search-input{flex:1;background:var(--navy-700);border:1px solid var(--navy-600);border-radius:10px;padding:12px 16px;color:var(--white);font-size:14px;font-family:inherit}
        .search-input:focus{outline:none;border-color:var(--teal-400)}
        .filter-select{background:var(--navy-700);border:1px solid var(--navy-600);border-radius:10px;padding:12px 16px;color:var(--white);font-size:14px;font-family:inherit;min-width:150px}
        .empty-state{text-align:center;padding:60px 24px}
        .empty-state h3{font-size:18px;font-weight:600;margin-bottom:8px}
        .empty-state p{font-size:14px;color:var(--gray-500);margin-bottom:24px}
        .toast-container{position:fixed;bottom:24px;right:24px;z-index:2000;display:flex;flex-direction:column;gap:12px}
        .toast{background:var(--navy-700);border:1px solid var(--green-500);border-radius:12px;padding:16px 20px;display:flex;align-items:center;gap:12px;box-shadow:0 8px 32px rgba(0,0,0,0.3);animation:slideIn 0.3s ease;min-width:280px}
        @keyframes slideIn{from{transform:translateX(100%);opacity:0}to{transform:translateX(0);opacity:1}}
        @media(max-width:1200px){.stats-grid,.quick-actions{grid-template-columns:repeat(2,1fr)}.content-grid,.calc-layout{grid-template-columns:1fr}}
        @media(max-width:768px){.sidebar{transform:translateX(-100%);transition:transform 0.3s}.sidebar.open{transform:translateX(0)}.main-content{margin-left:0}.stats-grid,.quick-actions{grid-template-columns:1fr}.form-row,.calc-grid{grid-template-columns:1fr}.calc-grid .full{grid-column:span 1}.mobile-menu{display:flex!important}}
        .mobile-menu{display:none;position:fixed;bottom:24px;left:24px;z-index:101;width:56px;height:56px;border-radius:50%;background:var(--teal-500);border:none;color:var(--navy-900);font-size:24px;cursor:pointer;box-shadow:0 4px 16px rgba(45,212,191,0.4);align-items:center;justify-content:center}
    </style>
</head>
<body>
    <div class="toast-container" id="toastContainer"></div>
    <button class="mobile-menu" onclick="toggleSidebar()">‚ò∞</button>

    <div class="view active" id="loginView">
        <div class="auth-container">
            <div class="auth-card">
                <div class="logo">
                    <svg viewBox="0 0 40 40" fill="none"><rect x="4" y="24" width="8" height="12" rx="2" fill="url(#g1)"/><rect x="16" y="16" width="8" height="20" rx="2" fill="url(#g1)"/><rect x="28" y="8" width="8" height="28" rx="2" fill="url(#g1)"/><defs><linearGradient id="g1" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" stop-color="#2DD4BF"/><stop offset="100%" stop-color="#0D9488"/></linearGradient></defs></svg>
                    <div class="logo-text">Depreciation<span>IQ</span></div>
                </div>
                <h1 class="auth-title">Welcome back</h1>
                <p class="auth-subtitle">Sign in to your dashboard</p>
                <form class="auth-form" id="loginForm">
                    <div class="form-group"><label class="form-label">Email</label><input type="email" class="form-input" id="loginEmail" placeholder="you@company.com" required></div>
                    <div class="form-group"><label class="form-label">Password</label><input type="password" class="form-input" id="loginPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required></div>
                    <button type="submit" class="btn btn-primary btn-full">Sign In</button>
                </form>
                <p class="auth-footer">Don't have an account? <a onclick="showView('signupView')">Sign up free</a></p>
            </div>
        </div>
    </div>

    <div class="view" id="signupView">
        <div class="auth-container">
            <div class="auth-card">
                <div class="logo">
                    <svg viewBox="0 0 40 40" fill="none"><rect x="4" y="24" width="8" height="12" rx="2" fill="url(#g2)"/><rect x="16" y="16" width="8" height="20" rx="2" fill="url(#g2)"/><rect x="28" y="8" width="8" height="28" rx="2" fill="url(#g2)"/><defs><linearGradient id="g2" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" stop-color="#2DD4BF"/><stop offset="100%" stop-color="#0D9488"/></linearGradient></defs></svg>
                    <div class="logo-text">Depreciation<span>IQ</span></div>
                </div>
                <h1 class="auth-title">Create account</h1>
                <p class="auth-subtitle">Start your 14-day free trial</p>
                <form class="auth-form" id="signupForm">
                    <div class="form-row">
                        <div class="form-group"><label class="form-label">First name</label><input type="text" class="form-input" id="signupFirst" placeholder="John" required></div>
                        <div class="form-group"><label class="form-label">Last name</label><input type="text" class="form-input" id="signupLast" placeholder="Doe" required></div>
                    </div>
                    <div class="form-group"><label class="form-label">Email</label><input type="email" class="form-input" id="signupEmail" placeholder="you@company.com" required></div>
                    <div class="form-group"><label class="form-label">Password</label><input type="password" class="form-input" id="signupPassword" placeholder="Create password" required></div>
                    <button type="submit" class="btn btn-primary btn-full">Create Account</button>
                </form>
                <p class="auth-footer">Have an account? <a onclick="showView('loginView')">Sign in</a></p>
            </div>
        </div>
    </div>

    <div class="view" id="appView">
        <div class="app-layout">
            <aside class="sidebar" id="sidebar">
                <div class="sidebar-logo">
                    <svg viewBox="0 0 40 40" fill="none" width="36" height="36"><rect x="4" y="24" width="8" height="12" rx="2" fill="url(#g3)"/><rect x="16" y="16" width="8" height="20" rx="2" fill="url(#g3)"/><rect x="28" y="8" width="8" height="28" rx="2" fill="url(#g3)"/><defs><linearGradient id="g3" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" stop-color="#2DD4BF"/><stop offset="100%" stop-color="#0D9488"/></linearGradient></defs></svg>
                    <div class="logo-text">Depreciation<span>IQ</span></div>
                </div>
                <nav>
                    <div class="nav-section">
                        <div class="nav-label">Overview</div>
                        <div class="nav-item active" onclick="navigateTo('dashboard')"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="9" rx="1"/><rect x="14" y="3" width="7" height="5" rx="1"/><rect x="14" y="12" width="7" height="9" rx="1"/><rect x="3" y="16" width="7" height="5" rx="1"/></svg>Dashboard</div>
                        <div class="nav-item" onclick="navigateTo('assets')"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/></svg>Asset Vault<span class="nav-badge" id="assetCount">0</span></div>
                    </div>
                    <div class="nav-section">
                        <div class="nav-label">Calculators</div>
                        <div class="nav-item" onclick="navigateTo('calc-179')"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>Section 179</div>
                        <div class="nav-item" onclick="navigateTo('calc-macrs')"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="4" y="2" width="16" height="20" rx="2"/><path d="M8 6h8M8 10h8M8 14h4"/></svg>MACRS</div>
                        <div class="nav-item" onclick="navigateTo('calc-vehicle')"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M5 17h14v-5l-2-5H7L5 12v5z"/><circle cx="7.5" cy="17.5" r="1.5"/><circle cx="16.5" cy="17.5" r="1.5"/></svg>Vehicle</div>
                        <div class="nav-item" onclick="navigateTo('calc-realestate')"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/></svg>Real Estate</div>
                    </div>
                    <div class="nav-section">
                        <div class="nav-label">Tools</div>
                        <div class="nav-item" onclick="navigateTo('ai-chat')"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>AI Advisor</div>
                        <div class="nav-item" onclick="navigateTo('reports')"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14,2 14,8 20,8"/></svg>Reports</div>
                    </div>
                    <div class="nav-section">
                        <div class="nav-label">Account</div>
                        <div class="nav-item" onclick="logout()"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16,17 21,12 16,7"/><line x1="21" y1="12" x2="9" y2="12"/></svg>Sign Out</div>
                    </div>
                </nav>
                <div class="sidebar-footer">
                    <div class="user-card"><div class="user-avatar" id="userAvatar">U</div><div><div class="user-name" id="userName">User</div><div class="user-plan">Business Plan</div></div></div>
                </div>
            </aside>
            <main class="main-content" id="mainContent"></main>
        </div>
    </div>

    <div class="modal-overlay" id="assetModal">
        <div class="modal">
            <div class="modal-header"><h2 class="modal-title" id="assetModalTitle">Add Asset</h2><button class="modal-close" onclick="closeModal('assetModal')">√ó</button></div>
            <div class="modal-body">
                <form id="assetForm">
                    <input type="hidden" id="assetId">
                    <div class="form-row">
                        <div class="form-group"><label class="form-label">Asset Type</label><select class="form-select" id="assetType" required><option value="">Select...</option><option value="vehicle">üöó Vehicle</option><option value="equipment">üíª Equipment</option><option value="furniture">ü™ë Furniture</option><option value="realestate">üè† Real Estate</option><option value="other">üì¶ Other</option></select></div>
                        <div class="form-group"><label class="form-label">Status</label><select class="form-select" id="assetStatus"><option value="active">Active</option><option value="sold">Sold</option></select></div>
                    </div>
                    <div class="form-group"><label class="form-label">Asset Name</label><input type="text" class="form-input" id="assetName" placeholder="2024 Tesla Model Y" required></div>
                    <div class="form-row">
                        <div class="form-group"><label class="form-label">Purchase Date</label><input type="date" class="form-input" id="assetDate" required></div>
                        <div class="form-group"><label class="form-label">Purchase Price ($)</label><input type="number" class="form-input" id="assetPrice" placeholder="50000" required></div>
                    </div>
                    <div class="form-row">
                        <div class="form-group"><label class="form-label">Business Use %</label><input type="number" class="form-input" id="assetBusiness" value="100" min="0" max="100"></div>
                        <div class="form-group"><label class="form-label">Recovery Period</label><select class="form-select" id="assetPeriod"><option value="5">5 Years</option><option value="7" selected>7 Years</option><option value="15">15 Years</option><option value="27.5">27.5 Years</option><option value="39">39 Years</option></select></div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('assetModal')">Cancel</button>
                <button class="btn btn-danger hidden" id="deleteBtn" onclick="deleteAsset()">Delete</button>
                <button class="btn btn-primary" onclick="saveAsset()">Save</button>
            </div>
        </div>
    </div>

<script>
const STATE={user:null,assets:[],prefs:{taxBracket:0.24},page:'dashboard',chatHistory:[],apiKey:''};
function loadState(){const s=localStorage.getItem('diq_state');if(s)Object.assign(STATE,JSON.parse(s))}
function saveState(){localStorage.setItem('diq_state',JSON.stringify(STATE))}
function init(){loadState();if(STATE.user){showView('appView');updateUserUI();renderPage(STATE.page)}else{showView('loginView')}
document.getElementById('loginForm').addEventListener('submit',e=>{e.preventDefault();STATE.user={email:document.getElementById('loginEmail').value,name:document.getElementById('loginEmail').value.split('@')[0]};saveState();showView('appView');updateUserUI();renderPage('dashboard');toast('Welcome back!')});
document.getElementById('signupForm').addEventListener('submit',e=>{e.preventDefault();STATE.user={email:document.getElementById('signupEmail').value,name:document.getElementById('signupFirst').value+' '+document.getElementById('signupLast').value};saveState();showView('appView');updateUserUI();renderPage('dashboard');toast('Account created!')})}
function showView(id){document.querySelectorAll('.view').forEach(v=>v.classList.remove('active'));document.getElementById(id).classList.add('active')}
function toggleSidebar(){document.getElementById('sidebar').classList.toggle('open')}
function logout(){STATE.user=null;STATE.assets=[];saveState();showView('loginView');toast('Signed out')}
function updateUserUI(){if(STATE.user){document.getElementById('userName').textContent=STATE.user.name;document.getElementById('userAvatar').textContent=STATE.user.name.charAt(0).toUpperCase()}}
function navigateTo(page){STATE.page=page;saveState();document.querySelectorAll('.nav-item').forEach(n=>n.classList.remove('active'));event.target.closest('.nav-item')?.classList.add('active');renderPage(page);document.getElementById('sidebar').classList.remove('open')}
function toast(msg){const t=document.createElement('div');t.className='toast';t.innerHTML='<span>‚úì</span><span>'+msg+'</span>';document.getElementById('toastContainer').appendChild(t);setTimeout(()=>t.remove(),3000)}
function formatCurrency(n){return '$'+(n||0).toLocaleString('en-US',{minimumFractionDigits:0,maximumFractionDigits:0})}
function renderPage(page){const c=document.getElementById('mainContent');document.getElementById('assetCount').textContent=STATE.assets.length;
switch(page){case'dashboard':renderDashboard(c);break;case'assets':renderAssets(c);break;case'calc-179':render179(c);break;case'calc-macrs':renderMACRS(c);break;case'calc-vehicle':renderVehicle(c);break;case'calc-realestate':renderRealEstate(c);break;case'ai-chat':renderChat(c);break;case'reports':renderReports(c);break;default:renderDashboard(c)}}
function getStats(){const active=STATE.assets.filter(a=>a.status==='active');const totalValue=active.reduce((s,a)=>s+(a.price*a.business/100),0);let ytdDep=0;active.forEach(a=>{const basis=a.price*a.business/100;const annual=basis/(a.period||7);ytdDep+=annual});return{count:active.length,value:totalValue,dep:ytdDep,savings:ytdDep*STATE.prefs.taxBracket}}
function renderDashboard(c){const s=getStats();c.innerHTML='<div class="page-header"><div><h1 class="page-title">Dashboard</h1><p class="page-subtitle">Your financial command center</p></div><div class="header-actions"><button class="btn btn-secondary" onclick="navigateTo(\'reports\')">üìÑ Reports</button><button class="btn btn-primary" onclick="openAssetModal()">+ Add Asset</button></div></div><div class="stats-grid"><div class="stat-card"><div class="stat-icon teal">üì¶</div><div class="stat-value">'+s.count+'</div><div class="stat-label">Total Assets</div></div><div class="stat-card"><div class="stat-icon green">üí∞</div><div class="stat-value">'+formatCurrency(s.value)+'</div><div class="stat-label">Asset Value</div></div><div class="stat-card"><div class="stat-icon purple">üìâ</div><div class="stat-value">'+formatCurrency(s.dep)+'</div><div class="stat-label">YTD Depreciation</div></div><div class="stat-card"><div class="stat-icon orange">üíµ</div><div class="stat-value">'+formatCurrency(s.savings)+'</div><div class="stat-label">Tax Savings</div></div></div><div class="quick-actions"><div class="quick-action" onclick="openAssetModal()"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 8v8M8 12h8"/></svg><div class="title">Add Asset</div><div class="desc">Track new asset</div></div><div class="quick-action" onclick="navigateTo(\'calc-179\')"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg><div class="title">Section 179</div><div class="desc">Max deduction</div></div><div class="quick-action" onclick="navigateTo(\'ai-chat\')"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg><div class="title">AI Advisor</div><div class="desc">Tax strategy</div></div><div class="quick-action" onclick="navigateTo(\'reports\')"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/></svg><div class="title">Reports</div><div class="desc">PDF schedules</div></div></div><div class="content-grid"><div class="card"><div class="card-header"><h3 class="card-title">Recent Assets</h3><span style="color:var(--teal-400);cursor:pointer" onclick="navigateTo(\'assets\')">View All ‚Üí</span></div><div class="card-body np">'+(s.count===0?'<div class="empty-state"><h3>No assets yet</h3><p>Add your first asset to start tracking</p><button class="btn btn-primary" onclick="openAssetModal()">+ Add Asset</button></div>':STATE.assets.slice(0,4).map(a=>assetRow(a)).join(''))+'</div></div><div class="card"><div class="card-header"><h3 class="card-title">Tax Alerts</h3></div><div class="card-body"><div class="alert-list"><div class="alert-item" onclick="navigateTo(\'calc-179\')"><div class="alert-icon urgent">‚ö†Ô∏è</div><div><div class="alert-title">Section 179 Deadline</div><div class="alert-desc">Year-end approaching</div></div><div class="alert-time">Dec 31</div></div><div class="alert-item" onclick="navigateTo(\'calc-179\')"><div class="alert-icon warning">üìà</div><div><div class="alert-title">Bonus Depreciation</div><div class="alert-desc">60% ‚Üí 40% in 2025</div></div><div class="alert-time">Jan 1</div></div><div class="alert-item" onclick="navigateTo(\'ai-chat\')"><div class="alert-icon info">üí°</div><div><div class="alert-title">Heavy Vehicle Strategy</div><div class="alert-desc">Ask AI about 6,000 lb rule</div></div><div class="alert-time">Tip</div></div></div></div></div></div>'}
function assetRow(a){const icons={vehicle:'üöó',equipment:'üíª',furniture:'ü™ë',realestate:'üè†',other:'üì¶'};const basis=a.price*a.business/100;const years=Math.max(1,new Date().getFullYear()-new Date(a.date).getFullYear()+1);const pct=Math.min(100,(years/(a.period||7))*100);return'<div class="asset-row" onclick="openAssetModal(\''+a.id+'\')"><div class="asset-info"><div class="asset-icon">'+(icons[a.type]||'üì¶')+'</div><div><div class="asset-name">'+a.name+'</div><div class="asset-type">'+a.type+' ‚Ä¢ '+a.business+'%</div></div></div><div class="asset-value">'+formatCurrency(basis)+'</div><div><div class="dep-bar"><div class="dep-fill" style="width:'+pct+'%"></div></div><div style="font-size:12px;color:var(--gray-500);margin-top:4px">'+pct.toFixed(0)+'%</div></div><div><span class="status-badge '+a.status+'">'+a.status+'</span></div></div>'}
function renderAssets(c){c.innerHTML='<div class="page-header"><div><h1 class="page-title">Asset Vault</h1><p class="page-subtitle">All your depreciable assets</p></div><div class="header-actions"><button class="btn btn-primary" onclick="openAssetModal()">+ Add Asset</button></div></div><div class="search-bar"><input type="text" class="search-input" id="searchInput" placeholder="Search assets..." oninput="filterAssets()"><select class="filter-select" id="typeFilter" onchange="filterAssets()"><option value="">All Types</option><option value="vehicle">Vehicles</option><option value="equipment">Equipment</option><option value="furniture">Furniture</option><option value="realestate">Real Estate</option></select></div><div class="card"><div class="card-body np">'+(STATE.assets.length===0?'<div class="empty-state"><h3>No assets yet</h3><p>Add your first asset</p><button class="btn btn-primary" onclick="openAssetModal()">+ Add Asset</button></div>':'<div class="asset-header"><div>Asset</div><div>Value</div><div>Depreciated</div><div>Status</div></div><div id="assetList">'+STATE.assets.map(a=>assetRow(a)).join('')+'</div>')+'</div></div>'}
function filterAssets(){const search=document.getElementById('searchInput').value.toLowerCase();const type=document.getElementById('typeFilter').value;document.querySelectorAll('#assetList .asset-row').forEach(r=>{const name=r.querySelector('.asset-name').textContent.toLowerCase();const aType=r.querySelector('.asset-type').textContent.toLowerCase();r.style.display=(name.includes(search)&&(!type||aType.includes(type)))?'grid':'none'})}
let editId=null;
function openAssetModal(id){editId=id||null;document.getElementById('assetForm').reset();document.getElementById('assetDate').value=new Date().toISOString().split('T')[0];if(id){const a=STATE.assets.find(x=>x.id===id);if(a){document.getElementById('assetModalTitle').textContent='Edit Asset';document.getElementById('deleteBtn').classList.remove('hidden');document.getElementById('assetType').value=a.type;document.getElementById('assetStatus').value=a.status;document.getElementById('assetName').value=a.name;document.getElementById('assetDate').value=a.date;document.getElementById('assetPrice').value=a.price;document.getElementById('assetBusiness').value=a.business;document.getElementById('assetPeriod').value=a.period}}else{document.getElementById('assetModalTitle').textContent='Add Asset';document.getElementById('deleteBtn').classList.add('hidden')}document.getElementById('assetModal').classList.add('active')}
function closeModal(id){document.getElementById(id).classList.remove('active');editId=null}
function saveAsset(){const f=document.getElementById('assetForm');if(!f.checkValidity()){f.reportValidity();return}const data={id:editId||Date.now().toString(),type:document.getElementById('assetType').value,status:document.getElementById('assetStatus').value,name:document.getElementById('assetName').value,date:document.getElementById('assetDate').value,price:parseFloat(document.getElementById('assetPrice').value),business:parseFloat(document.getElementById('assetBusiness').value)||100,period:parseFloat(document.getElementById('assetPeriod').value)||7};if(editId){const idx=STATE.assets.findIndex(a=>a.id===editId);if(idx>-1)STATE.assets[idx]=data;toast('Asset updated')}else{STATE.assets.push(data);toast('Asset added')}saveState();closeModal('assetModal');renderPage(STATE.page)}
function deleteAsset(){if(editId){STATE.assets=STATE.assets.filter(a=>a.id!==editId);saveState();toast('Asset deleted')}closeModal('assetModal');renderPage(STATE.page)}
function render179(c){c.innerHTML='<div class="page-header"><div><h1 class="page-title">Section 179 Calculator</h1><p class="page-subtitle">2024 limit: $1,220,000</p></div></div><div class="calc-layout"><div class="calc-form"><h3 class="calc-title">üí∞ Calculate Deduction</h3><div class="calc-grid"><div class="form-group full"><label class="form-label">Equipment Cost ($)</label><input type="number" class="form-input" id="s179Cost" value="75000" onchange="calc179()"></div><div class="form-group"><label class="form-label">Business Income ($)</label><input type="number" class="form-input" id="s179Income" value="200000" onchange="calc179()"></div><div class="form-group"><label class="form-label">Tax Bracket</label><select class="form-select" id="s179Bracket" onchange="calc179()"><option value="0.22">22%</option><option value="0.24" selected>24%</option><option value="0.32">32%</option><option value="0.35">35%</option></select></div><div class="form-group"><label class="form-label">Business Use %</label><input type="number" class="form-input" id="s179Business" value="100" onchange="calc179()"></div><div class="form-group"><label class="form-label">Bonus Depreciation?</label><select class="form-select" id="s179Bonus" onchange="calc179()"><option value="1">Yes (60%)</option><option value="0">No</option></select></div></div></div><div class="calc-results"><h3 class="calc-title">üìä Results</h3><div id="s179Results"></div></div></div>';calc179()}
function calc179(){const cost=parseFloat(document.getElementById('s179Cost')?.value)||75000;const income=parseFloat(document.getElementById('s179Income')?.value)||200000;const bracket=parseFloat(document.getElementById('s179Bracket')?.value)||0.24;const business=(parseFloat(document.getElementById('s179Business')?.value)||100)/100;const useBonus=document.getElementById('s179Bonus')?.value==='1';const basis=cost*business;const s179=Math.min(basis,1220000,income);const bonus=useBonus?(basis-s179)*0.60:0;const total=s179+bonus;const savings=total*bracket;document.getElementById('s179Results').innerHTML='<div class="result-item"><div class="result-label">Section 179 Deduction</div><div class="result-value teal">'+formatCurrency(s179)+'</div></div>'+(useBonus?'<div class="result-item"><div class="result-label">Bonus Depreciation (60%)</div><div class="result-value">'+formatCurrency(bonus)+'</div></div>':'')+'<div class="result-item"><div class="result-label">Total Year 1 Deduction</div><div class="result-value">'+formatCurrency(total)+'</div></div><div class="result-item"><div class="result-label">Tax Savings</div><div class="result-value green">'+formatCurrency(savings)+'</div></div><div class="result-item"><div class="result-label">Effective Cost</div><div class="result-value">'+formatCurrency(cost-savings)+'</div></div>'}
function renderMACRS(c){c.innerHTML='<div class="page-header"><div><h1 class="page-title">MACRS Calculator</h1><p class="page-subtitle">Modified Accelerated Cost Recovery</p></div></div><div class="calc-layout"><div class="calc-form"><h3 class="calc-title">üìä Asset Details</h3><div class="calc-grid"><div class="form-group full"><label class="form-label">Cost Basis ($)</label><input type="number" class="form-input" id="macrsCost" value="50000" onchange="calcMACRS()"></div><div class="form-group"><label class="form-label">Recovery Period</label><select class="form-select" id="macrsPeriod" onchange="calcMACRS()"><option value="5">5 Years</option><option value="7" selected>7 Years</option><option value="15">15 Years</option><option value="27.5">27.5 Years</option><option value="39">39 Years</option></select></div><div class="form-group"><label class="form-label">Tax Bracket</label><select class="form-select" id="macrsBracket" onchange="calcMACRS()"><option value="0.24" selected>24%</option><option value="0.32">32%</option><option value="0.35">35%</option></select></div></div></div><div class="calc-results"><h3 class="calc-title">üìà Results</h3><div id="macrsResults"></div></div></div><div class="card" style="margin-top:32px"><div class="card-header"><h3 class="card-title">Depreciation Schedule</h3></div><div class="card-body"><table class="schedule-table"><thead><tr><th>Year</th><th>Rate</th><th>Depreciation</th><th>Tax Savings</th></tr></thead><tbody id="macrsSchedule"></tbody></table></div></div>';calcMACRS()}
function calcMACRS(){const cost=parseFloat(document.getElementById('macrsCost')?.value)||50000;const period=parseFloat(document.getElementById('macrsPeriod')?.value)||7;const bracket=parseFloat(document.getElementById('macrsBracket')?.value)||0.24;const rates={5:[0.20,0.32,0.192,0.1152,0.1152,0.0576],7:[0.1429,0.2449,0.1749,0.1249,0.0893,0.0892,0.0893,0.0446],15:[0.05,0.095,0.0855,0.077,0.0693,0.0623,0.059,0.059,0.0591,0.059,0.0591,0.059,0.0591,0.059,0.0591,0.0295],27.5:Array(28).fill(1/27.5),39:Array(40).fill(1/39)};const r=rates[period]||rates[7];const y1=cost*r[0];document.getElementById('macrsResults').innerHTML='<div class="result-item"><div class="result-label">Year 1 Depreciation</div><div class="result-value teal">'+formatCurrency(y1)+'</div></div><div class="result-item"><div class="result-label">Year 1 Tax Savings</div><div class="result-value green">'+formatCurrency(y1*bracket)+'</div></div><div class="result-item"><div class="result-label">Total Depreciation</div><div class="result-value">'+formatCurrency(cost)+'</div></div><div class="result-item"><div class="result-label">Recovery Period</div><div class="result-value">'+period+' Years</div></div>';let html='';r.forEach((rate,i)=>{const dep=cost*rate;html+='<tr><td>Year '+(i+1)+'</td><td>'+(rate*100).toFixed(2)+'%</td><td>'+formatCurrency(dep)+'</td><td>'+formatCurrency(dep*bracket)+'</td></tr>'});document.getElementById('macrsSchedule').innerHTML=html}
function renderVehicle(c){c.innerHTML='<div class="page-header"><div><h1 class="page-title">Vehicle Calculator</h1><p class="page-subtitle">Cars, trucks, and SUVs</p></div></div><div class="calc-layout"><div class="calc-form"><h3 class="calc-title">üöó Vehicle Details</h3><div class="calc-grid"><div class="form-group"><label class="form-label">Vehicle Type</label><select class="form-select" id="vehType" onchange="calcVehicle()"><option value="car">Car (under 6,000 lbs)</option><option value="heavy">Heavy SUV/Truck (6,000+ lbs)</option></select></div><div class="form-group"><label class="form-label">Purchase Price ($)</label><input type="number" class="form-input" id="vehPrice" value="55000" onchange="calcVehicle()"></div><div class="form-group"><label class="form-label">Business Use %</label><input type="number" class="form-input" id="vehBusiness" value="100" onchange="calcVehicle()"></div><div class="form-group"><label class="form-label">Tax Bracket</label><select class="form-select" id="vehBracket" onchange="calcVehicle()"><option value="0.24" selected>24%</option><option value="0.32">32%</option><option value="0.35">35%</option></select></div></div><div style="margin-top:24px;padding:16px;background:var(--navy-700);border-radius:12px"><p style="font-size:14px;font-weight:600;color:var(--teal-400)">üöõ Heavy Vehicle Advantage</p><p style="font-size:13px;color:var(--gray-400);margin-top:8px">Vehicles over 6,000 lbs GVWR bypass passenger auto limits. Full Section 179 up to $30,500 plus 60% bonus!</p></div></div><div class="calc-results"><h3 class="calc-title">üìä Results</h3><div id="vehResults"></div></div></div>';calcVehicle()}
function calcVehicle(){const type=document.getElementById('vehType')?.value||'car';const price=parseFloat(document.getElementById('vehPrice')?.value)||55000;const business=(parseFloat(document.getElementById('vehBusiness')?.value)||100)/100;const bracket=parseFloat(document.getElementById('vehBracket')?.value)||0.24;const basis=price*business;let y1,strategy;if(type==='heavy'){const s179=Math.min(basis,30500);const bonus=(basis-s179)*0.60;y1=s179+bonus;strategy='Section 179 ('+formatCurrency(s179)+') + Bonus ('+formatCurrency(bonus)+')'}else{y1=Math.min(basis,20200);strategy='Limited by passenger auto rules'}const savings=y1*bracket;document.getElementById('vehResults').innerHTML='<div class="result-item"><div class="result-label">Year 1 Deduction</div><div class="result-value teal">'+formatCurrency(y1)+'</div></div><div class="result-item"><div class="result-label">Tax Savings</div><div class="result-value green">'+formatCurrency(savings)+'</div></div><div class="result-item"><div class="result-label">Effective Cost</div><div class="result-value">'+formatCurrency(price-savings)+'</div></div><div class="result-item"><div class="result-label">Strategy</div><div class="result-sub">'+strategy+'</div></div>'+(type==='heavy'?'<div style="margin-top:16px;padding:16px;background:var(--teal-glow);border-radius:12px"><p style="font-size:14px;color:var(--teal-400);font-weight:600">‚úì Heavy Vehicle Qualified</p><p style="font-size:13px;color:var(--gray-300);margin-top:4px">This vehicle bypasses the $20,200 limit!</p></div>':'')}
function renderRealEstate(c){c.innerHTML='<div class="page-header"><div><h1 class="page-title">Real Estate Calculator</h1><p class="page-subtitle">Rental and commercial property</p></div></div><div class="calc-layout"><div class="calc-form"><h3 class="calc-title">üè† Property Details</h3><div class="calc-grid"><div class="form-group"><label class="form-label">Property Type</label><select class="form-select" id="reType" onchange="calcRE()"><option value="residential">Residential (27.5 yrs)</option><option value="commercial">Commercial (39 yrs)</option></select></div><div class="form-group"><label class="form-label">Purchase Price ($)</label><input type="number" class="form-input" id="rePrice" value="450000" onchange="calcRE()"></div><div class="form-group"><label class="form-label">Land Value ($)</label><input type="number" class="form-input" id="reLand" value="100000" onchange="calcRE()"></div><div class="form-group"><label class="form-label">Tax Bracket</label><select class="form-select" id="reBracket" onchange="calcRE()"><option value="0.24" selected>24%</option><option value="0.32">32%</option><option value="0.35">35%</option></select></div></div></div><div class="calc-results"><h3 class="calc-title">üìä Results</h3><div id="reResults"></div></div></div>';calcRE()}
function calcRE(){const type=document.getElementById('reType')?.value||'residential';const price=parseFloat(document.getElementById('rePrice')?.value)||450000;const land=parseFloat(document.getElementById('reLand')?.value)||100000;const bracket=parseFloat(document.getElementById('reBracket')?.value)||0.24;const basis=price-land;const years=type==='residential'?27.5:39;const annual=basis/years;document.getElementById('reResults').innerHTML='<div class="result-item"><div class="result-label">Depreciable Basis</div><div class="result-value">'+formatCurrency(basis)+'</div><div class="result-sub">Price minus land</div></div><div class="result-item"><div class="result-label">Annual Depreciation</div><div class="result-value teal">'+formatCurrency(annual)+'</div></div><div class="result-item"><div class="result-label">Monthly</div><div class="result-value">'+formatCurrency(annual/12)+'</div></div><div class="result-item"><div class="result-label">Annual Tax Savings</div><div class="result-value green">'+formatCurrency(annual*bracket)+'</div></div><div class="result-item"><div class="result-label">Recovery Period</div><div class="result-value">'+years+' Years</div></div>'}
function renderChat(c){c.innerHTML='<div class="page-header"><div><h1 class="page-title">AI Tax Advisor</h1><p class="page-subtitle">Ask about depreciation strategy</p></div><button class="btn btn-secondary btn-sm" onclick="configAPI()">‚öôÔ∏è API Key</button></div><div class="card" style="height:calc(100vh-180px);display:flex;flex-direction:column"><div class="chat-messages" id="chatMessages">'+(STATE.chatHistory.length===0?'<div class="chat-message assistant"><div class="chat-avatar">AI</div><div class="chat-bubble">üëã Hi! Ask me about Section 179, bonus depreciation, vehicle strategies, or real estate depreciation.</div></div>':STATE.chatHistory.map(m=>'<div class="chat-message '+m.role+'"><div class="chat-avatar">'+(m.role==='user'?(STATE.user?.name?.charAt(0)||'U'):'AI')+'</div><div class="chat-bubble">'+m.content+'</div></div>').join(''))+'</div><div class="chat-input-container"><textarea class="chat-input" id="chatInput" placeholder="Ask about depreciation..." rows="1" onkeydown="if(event.key===\'Enter\'&&!event.shiftKey){event.preventDefault();sendChat()}"></textarea><button class="btn btn-primary" onclick="sendChat()">Send</button></div></div>'}
function sendChat(){const input=document.getElementById('chatInput');const msg=input.value.trim();if(!msg)return;input.value='';STATE.chatHistory.push({role:'user',content:msg});saveState();const messages=document.getElementById('chatMessages');messages.innerHTML+='<div class="chat-message user"><div class="chat-avatar">'+(STATE.user?.name?.charAt(0)||'U')+'</div><div class="chat-bubble">'+msg+'</div></div>';messages.scrollTop=messages.scrollHeight;let response;const lower=msg.toLowerCase();if(lower.includes('179'))response='<strong>Section 179 (2024)</strong><br><br>‚Ä¢ Max: $1,220,000<br>‚Ä¢ Phase-out: $3,050,000<br>‚Ä¢ SUV limit: $30,500<br><br>Combine with 60% bonus depreciation!';else if(lower.includes('vehicle')||lower.includes('car')||lower.includes('truck'))response='<strong>Vehicle Strategy</strong><br><br>Standard cars: Year 1 limit $20,200<br><br>Heavy vehicles (6,000+ lbs): Full Section 179 + bonus. A $55K truck = $45K+ deduction!';else if(lower.includes('bonus'))response='<strong>Bonus Depreciation</strong><br><br>‚Ä¢ 2024: 60%<br>‚Ä¢ 2025: 40%<br>‚Ä¢ 2026: 20%<br><br>Buy equipment now while rates are higher!';else if(lower.includes('real estate')||lower.includes('rental'))response='<strong>Real Estate</strong><br><br>‚Ä¢ Residential: 27.5 years<br>‚Ä¢ Commercial: 39 years<br><br>Cost segregation can accelerate $50K+ in deductions!';else response='Ask about:<br>‚Ä¢ Section 179<br>‚Ä¢ Bonus depreciation<br>‚Ä¢ Vehicle strategy<br>‚Ä¢ Real estate<br>‚Ä¢ Cost segregation';setTimeout(()=>{STATE.chatHistory.push({role:'assistant',content:response});saveState();messages.innerHTML+='<div class="chat-message assistant"><div class="chat-avatar">AI</div><div class="chat-bubble">'+response+'</div></div>';messages.scrollTop=messages.scrollHeight},500)}
function configAPI(){const key=prompt('Enter Anthropic API key:',STATE.apiKey);if(key!==null){STATE.apiKey=key;saveState();toast('API key saved')}}
function renderReports(c){c.innerHTML='<div class="page-header"><div><h1 class="page-title">Reports</h1><p class="page-subtitle">Generate PDF reports</p></div></div><div class="quick-actions" style="grid-template-columns:repeat(3,1fr)"><div class="quick-action" onclick="generateReport(\'summary\')"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/></svg><div class="title">Asset Summary</div><div class="desc">All assets</div></div><div class="quick-action" onclick="generateReport(\'schedule\')"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="4" width="18" height="18" rx="2"/><path d="M16 2v4M8 2v4M3 10h18"/></svg><div class="title">Depreciation Schedule</div><div class="desc">Year-by-year</div></div><div class="quick-action" onclick="generateReport(\'tax\')"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg><div class="title">Tax Savings</div><div class="desc">Deductions</div></div></div>'}
function generateReport(type){const{jsPDF}=window.jspdf;const doc=new jsPDF();const s=getStats();doc.setFontSize(22);doc.setTextColor(45,212,191);doc.text('DepreciationIQ',20,25);doc.setFontSize(16);doc.setTextColor(0);doc.text(type==='summary'?'Asset Summary':type==='schedule'?'Depreciation Schedule':'Tax Savings Report',20,40);doc.setFontSize(10);doc.setTextColor(100);doc.text('Generated: '+new Date().toLocaleDateString(),20,50);doc.setFontSize(12);doc.setTextColor(0);let y=70;doc.text('Total Assets: '+s.count,20,y);y+=10;doc.text('Total Value: '+formatCurrency(s.value),20,y);y+=10;doc.text('YTD Depreciation: '+formatCurrency(s.dep),20,y);y+=10;doc.text('Tax Savings: '+formatCurrency(s.savings),20,y);y+=20;if(STATE.assets.length>0){doc.setFontSize(14);doc.text('Assets:',20,y);y+=10;doc.setFontSize(10);STATE.assets.forEach(a=>{doc.text('‚Ä¢ '+a.name+' - '+formatCurrency(a.price*a.business/100),25,y);y+=8;if(y>270){doc.addPage();y=20}})}doc.save('DepreciationIQ_'+type+'_'+new Date().toISOString().split('T')[0]+'.pdf');toast('Report downloaded!')}
init();
</script>
</body>
</html>
